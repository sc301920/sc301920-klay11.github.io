# 应用程序缓存
使用 HTML5，通过创建 cache manifest 文件，可以轻松地创建 web 应用的离线版本。
- 离线浏览 - 用户可在应用离线时使用它们
- 速度 - 已缓存资源加载得更快
- 减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。
**应用场景h5游戏或离线问题**
### HTML5 应用程序缓存
HTML5离线缓存主要通过html元素的manifest属性指定一个后缀为manifest的文件，该文件为网页指定哪些文件需要被缓存，哪些不需要缓存，以及获取失败的处理方式等等，
1. CACHE MANIFEST：标题，位于文件首行，如果没有指定标题，会导致文件解析失败
2. CACHE：该部分指定需要缓存的文件列表，内容为相对路径，对应html文件中引入的路径，一般来说主文档无需添加，默认缓存。
3. NETWORK：指定不需要缓存的文件，即永远从服务端获取。
4. FALLBACK：指定文件获取失败后的处理方式。
```
CACHE MANIFEST

CACHE:
./js/main.js
./css/main.css

NETWORK:
signup.html # 不缓存登陆页面

FALLBACK:
signup.html offline.html
# 当无法获取到该路径下的请求时，所有请求都会被转发到default.html文件来处理
/app/ajax/ default.html

```
工作流程: 
1. 首次访问页面，浏览器加载页面和所需资源
2. 解析到html元素的manifest文件，加载CACHE以及FALLBACK对应的资源到缓存中
3. 从现在起你将完全使用浏览器缓存中的文件，即使强制刷新也不会生效。随后浏览器会尝试检查manifest文件是否更新（联机状态才会检查）。若manifest文件更新，浏览器会下载所有资源并更新缓存。
4. 离线状态下访问已缓存的资源时，浏览器会从缓存中读取，而相应的，访NETWORK中的资源则会对应读取FALLBACK
> 只有manifest文件更新，浏览器才会重新下载新资源，意味着仅仅更改资源文件内容是不会触发更新的。这一问题可以通过在manifest中添加版本注释来解决。且更新缓存并不会立即生效，需下次访问生效！可通过浏览器API监听相应的事件，提醒用户刷新浏览器

